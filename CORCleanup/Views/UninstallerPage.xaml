<Page x:Class="CORCleanup.Views.UninstallerPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      Title="Uninstaller">
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Controls bar -->
        <Grid Grid.Row="0" Margin="0,0,0,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <ui:Button Grid.Column="0"
                       Content="Load Programmes"
                       Appearance="Primary"
                       Command="{Binding ViewModel.LoadProgramsCommand}"
                       MinWidth="140"
                       Margin="0,0,12,0" />

            <ui:TextBox Grid.Column="1"
                        PlaceholderText="Search by name or publisher..."
                        Text="{Binding ViewModel.SearchFilter, UpdateSourceTrigger=PropertyChanged}" />

            <ui:Button Grid.Column="2"
                       Content="Uninstall Selected"
                       Appearance="Danger"
                       Command="{Binding ViewModel.UninstallSelectedCommand}"
                       MinWidth="140"
                       Margin="12,0,0,0" />
        </Grid>

        <!-- Programme count -->
        <TextBlock Grid.Row="1"
                   Margin="0,0,0,8"
                   Opacity="0.6"
                   FontSize="12">
            <TextBlock.Text>
                <MultiBinding StringFormat="{}{0} programme(s) shown">
                    <Binding Path="ViewModel.FilteredPrograms.Count" />
                </MultiBinding>
            </TextBlock.Text>
        </TextBlock>

        <!-- Programme list -->
        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding ViewModel.FilteredPrograms}"
                  SelectedItem="{Binding ViewModel.SelectedProgram}"
                  SelectionMode="Single">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Name"
                                    Binding="{Binding DisplayName}"
                                    Width="*" />
                <DataGridTextColumn Header="Publisher"
                                    Binding="{Binding Publisher}"
                                    Width="180" />
                <DataGridTextColumn Header="Version"
                                    Binding="{Binding DisplayVersion}"
                                    Width="100" />
                <DataGridTextColumn Header="Size"
                                    Binding="{Binding SizeFormatted}"
                                    Width="80" />
                <DataGridTextColumn Header="Installed"
                                    Binding="{Binding InstallDateFormatted}"
                                    Width="100" />
            </DataGrid.Columns>
        </DataGrid>

        <!-- Status bar -->
        <TextBlock Grid.Row="3"
                   Text="{Binding ViewModel.StatusText}"
                   Opacity="0.6"
                   FontSize="12"
                   Margin="0,8,0,0" />
    </Grid>
</Page>
