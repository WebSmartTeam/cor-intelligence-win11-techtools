<Page x:Class="CORCleanup.Views.HelpPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:vm="clr-namespace:CORCleanup.ViewModels"
      d:DataContext="{d:DesignInstance vm:HelpViewModel}"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      mc:Ignorable="d"
      Title="Help"
      Background="{DynamicResource ApplicationBackgroundBrush}">

    <ScrollViewer VerticalScrollBarVisibility="Auto" CanContentScroll="False">
        <StackPanel Margin="12,6" MaxWidth="900">

            <!-- ============================================================ -->
            <!-- Header                                                       -->
            <!-- ============================================================ -->
            <DockPanel Margin="0,0,0,10">
                <TextBlock DockPanel.Dock="Left"
                           Text="Help &amp; Reference"
                           FontSize="16" FontWeight="SemiBold"
                           VerticalAlignment="Center" />
            </DockPanel>

            <TextBlock Text="Search and browse all tools included in COR Cleanup. Click any section to see available features and what they do."
                       FontSize="12" Opacity="0.6" TextWrapping="Wrap"
                       Margin="0,0,0,12" />

            <!-- ============================================================ -->
            <!-- Search Box                                                   -->
            <!-- ============================================================ -->
            <ui:TextBox PlaceholderText="Search tools..."
                        Text="{Binding ViewModel.SearchQuery, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Margin="0,0,0,16"
                        Icon="{ui:SymbolIcon Search24}" />

            <!-- ============================================================ -->
            <!-- Tool Sections                                                -->
            <!-- ============================================================ -->
            <ItemsControl ItemsSource="{Binding ViewModel.FilteredSections}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type vm:ToolSection}">
                        <ui:Card Padding="16" Margin="0,0,0,12">
                            <StackPanel>
                                <!-- Section Header -->
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <ui:SymbolIcon Symbol="Wrench24"
                                                   FontSize="16" Margin="0,0,8,0"
                                                   Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" />
                                    <TextBlock Text="{Binding Name}"
                                               FontSize="15" FontWeight="SemiBold"
                                               VerticalAlignment="Center" />
                                    <Border Background="{DynamicResource CorAccentBrush}"
                                            CornerRadius="{StaticResource CorBadgeRadius}"
                                            Padding="6,2" Margin="8,0,0,0"
                                            VerticalAlignment="Center">
                                        <TextBlock FontSize="10" Foreground="White">
                                            <TextBlock.Text>
                                                <MultiBinding StringFormat="{}{0} tools">
                                                    <Binding Path="Tools.Count" />
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                    </Border>
                                </StackPanel>

                                <!-- Tool List -->
                                <ItemsControl ItemsSource="{Binding Tools}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate DataType="{x:Type vm:ToolInfo}">
                                            <Border Padding="8,6" Margin="0,0,0,2"
                                                    CornerRadius="4"
                                                    Background="Transparent">
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Name}"
                                                               FontSize="13" FontWeight="SemiBold" />
                                                    <TextBlock Text="{Binding Description}"
                                                               FontSize="11.5" Opacity="0.65"
                                                               TextWrapping="Wrap"
                                                               Margin="0,2,0,0" />
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </ui:Card>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- ============================================================ -->
            <!-- No Results                                                   -->
            <!-- ============================================================ -->
            <TextBlock Text="No matching tools found. Try a different search term."
                       FontSize="12" Opacity="0.5"
                       HorizontalAlignment="Center"
                       Margin="0,20,0,20">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ViewModel.FilteredSections.Count}" Value="0">
                                <Setter Property="Visibility" Value="Visible" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>

            <!-- ============================================================ -->
            <!-- Idea Portal Banner                                           -->
            <!-- ============================================================ -->
            <ui:Card Padding="16" Margin="0,4,0,20">
                <DockPanel>
                    <StackPanel DockPanel.Dock="Left" VerticalAlignment="Center">
                        <StackPanel Orientation="Horizontal">
                            <ui:SymbolIcon Symbol="Lightbulb24" FontSize="18"
                                          Foreground="{DynamicResource CorWarningBrush}"
                                          Margin="0,0,8,0" />
                            <TextBlock Text="Got a feature idea?"
                                       FontSize="14" FontWeight="SemiBold"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                        <TextBlock Text="Submit your suggestions on the COR Intelligence Idea Portal. We read every submission."
                                   FontSize="11.5" Opacity="0.6"
                                   TextWrapping="Wrap" Margin="0,4,0,0" />
                    </StackPanel>
                    <ui:Button DockPanel.Dock="Right"
                               Appearance="Primary"
                               Content="Open Idea Portal"
                               Icon="{ui:SymbolIcon Open24}"
                               HorizontalAlignment="Right"
                               VerticalAlignment="Center"
                               Command="{Binding ViewModel.OpenIdeaPortalCommand}" />
                </DockPanel>
            </ui:Card>

        </StackPanel>
    </ScrollViewer>
</Page>
