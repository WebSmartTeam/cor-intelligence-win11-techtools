<Page x:Class="CORCleanup.Views.HardwarePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      Title="Hardware"
      Loaded="Page_Loaded"
      Background="{DynamicResource ApplicationBackgroundBrush}">


    <Grid Margin="12,8">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TabControl Grid.Row="0"
                    SelectedIndex="{Binding ViewModel.SelectedTabIndex}">

            <!-- ============================================================ -->
            <!-- TAB 0: COR Spec (Speccy-style full system summary) -->
            <!-- ============================================================ -->
            <TabItem Header="COR Spec">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Header bar -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="16,12,16,0">
                        <TextBlock Text="COR Spec" FontSize="20" FontWeight="Bold"
                                   Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                                   VerticalAlignment="Center" Margin="0,0,16,0" />
                        <ui:Button Content="Refresh"
                                   Command="{Binding ViewModel.LoadCorSpecCommand}"
                                   Appearance="Primary" Margin="0,0,8,0" />
                        <ui:Button Content="Copy to Clipboard"
                                   Command="{Binding ViewModel.CopyCorSpecToClipboardCommand}"
                                   Margin="0,0,8,0" />
                        <ui:Button Content="Export"
                                   Command="{Binding ViewModel.ExportCorSpecCommand}" />
                    </StackPanel>

                    <!-- Loading bar -->
                    <ProgressBar Grid.Row="1" IsIndeterminate="True" Height="3" Margin="16,8,16,0"
                                 Visibility="{Binding ViewModel.IsLoadingCorSpec, Converter={StaticResource BoolToVis}}" />

                    <!-- Scrollable content -->
                    <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" Padding="16,8,16,16">
                        <StackPanel Visibility="{Binding ViewModel.CorSpecReport, Converter={StaticResource NullToVis}}">

                            <!-- Operating System -->
                            <ui:Card Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon Symbol="Desktop24" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="Operating System" FontSize="15" FontWeight="SemiBold" />
                                    </StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Edition" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.OsEdition}" TextWrapping="Wrap" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Version" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.OsVersion}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Build" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.OsBuild}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Install Date" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.InstallDate, StringFormat=dd/MM/yyyy}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Computer Name" Opacity="0.6" />
                                        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.ComputerName}" />
                                    </Grid>
                                </StackPanel>
                            </ui:Card>

                            <!-- Processor -->
                            <ui:Card Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon Symbol="TopSpeed24" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="Processor" FontSize="15" FontWeight="SemiBold" />
                                    </StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="CPU" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.CpuName}" TextWrapping="Wrap" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Cores / Threads" Opacity="0.6" Margin="0,0,0,4" />
                                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,4">
                                            <TextBlock Text="{Binding ViewModel.CorSpecReport.System.CpuCores}" />
                                            <TextBlock Text=" / " />
                                            <TextBlock Text="{Binding ViewModel.CorSpecReport.System.CpuThreads}" />
                                        </StackPanel>
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Max Clock" Opacity="0.6" />
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.CpuMaxClockMhz, StringFormat={}{0} MHz}" />
                                    </Grid>
                                </StackPanel>
                            </ui:Card>

                            <!-- Memory -->
                            <ui:Card Padding="16" Margin="0,0,0,12"
                                     Visibility="{Binding ViewModel.CorSpecReport.Ram, Converter={StaticResource NullToVis}}">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon Symbol="SlideSize24" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="Memory" FontSize="15" FontWeight="SemiBold" />
                                    </StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Installed" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.Ram.InstalledFormatted}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Slots" Opacity="0.6" Margin="0,0,0,4" />
                                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,4">
                                            <TextBlock Text="{Binding ViewModel.CorSpecReport.Ram.UsedSlots}" />
                                            <TextBlock Text=" of " />
                                            <TextBlock Text="{Binding ViewModel.CorSpecReport.Ram.TotalSlots}" />
                                            <TextBlock Text=" used" />
                                        </StackPanel>
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Max Capacity" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.Ram.MaxCapacityFormatted}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Channel Config" Opacity="0.6" />
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.Ram.ChannelConfig}" />
                                    </Grid>

                                    <!-- Per-DIMM breakdown -->
                                    <ItemsControl ItemsSource="{Binding ViewModel.CorSpecReport.Ram.Dimms}" Margin="0,8,0,0">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,2">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="140" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="{Binding SlotLabel}" Opacity="0.6" />
                                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                                        <TextBlock Text="{Binding CapacityFormatted}" />
                                                        <TextBlock Text=" " />
                                                        <TextBlock Text="{Binding MemoryType}" />
                                                        <TextBlock Text="-" />
                                                        <TextBlock Text="{Binding SpeedMhz}" />
                                                        <TextBlock Text=" (" />
                                                        <TextBlock Text="{Binding Manufacturer}" />
                                                        <TextBlock Text=")" />
                                                    </StackPanel>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </ui:Card>

                            <!-- Motherboard -->
                            <ui:Card Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon Symbol="Desktop24" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="Motherboard" FontSize="15" FontWeight="SemiBold" />
                                    </StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Manufacturer" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.MotherboardManufacturer}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Product" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.MotherboardProduct}" TextWrapping="Wrap" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="BIOS" Opacity="0.6" />
                                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                            <TextBlock Text="{Binding ViewModel.CorSpecReport.System.BiosVersion}" />
                                            <TextBlock Text=" (" />
                                            <TextBlock Text="{Binding ViewModel.CorSpecReport.System.BiosDate}" />
                                            <TextBlock Text=")" />
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </ui:Card>

                            <!-- Graphics -->
                            <ui:Card Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon Symbol="Video24" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="Graphics" FontSize="15" FontWeight="SemiBold" />
                                    </StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="GPU" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.GpuName}" TextWrapping="Wrap" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="VRAM" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.GpuVramFormatted}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Driver" Opacity="0.6" />
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.System.GpuDriverVersion}" />
                                    </Grid>
                                </StackPanel>
                            </ui:Card>

                            <!-- Storage -->
                            <ui:Card Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon Symbol="SlideSize24" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="Storage" FontSize="15" FontWeight="SemiBold" />
                                    </StackPanel>

                                    <!-- Physical Disks -->
                                    <ItemsControl ItemsSource="{Binding ViewModel.CorSpecReport.PhysicalDisks}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Margin="0,0,0,8">
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Model}" FontWeight="SemiBold" />
                                                        <TextBlock Text=" — " Opacity="0.5" />
                                                        <TextBlock Text="{Binding TypeSummary}" Opacity="0.7" />
                                                        <TextBlock Text=" — " Opacity="0.5" />
                                                        <TextBlock Text="{Binding SizeFormatted}" Opacity="0.7" />
                                                    </StackPanel>
                                                    <StackPanel Orientation="Horizontal" Margin="140,2,0,0">
                                                        <TextBlock Text="Health: " Opacity="0.6" />
                                                        <TextBlock Text="{Binding HealthDisplay}" FontWeight="SemiBold" />
                                                        <TextBlock Text="  Temp: " Opacity="0.6" Margin="12,0,0,0" />
                                                        <TextBlock Text="{Binding TemperatureDisplay}" />
                                                        <TextBlock Text="  Power-On: " Opacity="0.6" Margin="12,0,0,0" />
                                                        <TextBlock Text="{Binding PowerOnDisplay}" />
                                                        <TextBlock Text=" hrs" Opacity="0.6" />
                                                        <TextBlock Text="  Wear: " Opacity="0.6" Margin="12,0,0,0" />
                                                        <TextBlock Text="{Binding WearDisplay}" />
                                                    </StackPanel>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>

                                    <!-- Logical Volumes -->
                                    <TextBlock Text="Logical Volumes" FontWeight="SemiBold" Opacity="0.8" Margin="0,8,0,6"
                                               Visibility="{Binding ViewModel.CorSpecReport.HasVolumes, Converter={StaticResource BoolToVis}}" />
                                    <ItemsControl ItemsSource="{Binding ViewModel.CorSpecReport.LogicalVolumes}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,2,0,4">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="140" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="120" />
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Opacity="0.6">
                                                        <Run Text="{Binding DisplayLabel, Mode=OneWay}" />
                                                        <Run Text=" " />
                                                        <Run Text="{Binding FileSystem, Mode=OneWay}" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" />
                                                    </TextBlock>
                                                    <ProgressBar Grid.Column="1" Value="{Binding UsedPercent, Mode=OneWay}" Maximum="100" Height="8"
                                                                 Margin="0,4,8,0" />
                                                    <TextBlock Grid.Column="2" FontSize="12" Opacity="0.7" VerticalAlignment="Center">
                                                        <Run Text="{Binding FreeFormatted, Mode=OneWay}" />
                                                        <Run Text=" free / " />
                                                        <Run Text="{Binding SizeFormatted, Mode=OneWay}" />
                                                    </TextBlock>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </ui:Card>

                            <!-- Audio -->
                            <ui:Card Padding="16" Margin="0,0,0,12">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon Symbol="Speaker224" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="Audio" FontSize="15" FontWeight="SemiBold" />
                                    </StackPanel>
                                    <ItemsControl ItemsSource="{Binding ViewModel.CorSpecReport.AudioDevices}"
                                                  Visibility="{Binding ViewModel.CorSpecReport.HasAudio, Converter={StaticResource BoolToVis}}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,2">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="140" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="{Binding Name}" TextWrapping="Wrap" />
                                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Manufacturer}" Opacity="0.6" />
                                                        <TextBlock Text=" — " Opacity="0.4" />
                                                        <TextBlock Text="{Binding Status}" Opacity="0.6" />
                                                    </StackPanel>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                    <TextBlock Text="No audio devices detected" Opacity="0.5" FontStyle="Italic"
                                               Visibility="{Binding ViewModel.CorSpecReport.HasAudio, Converter={StaticResource InverseBoolToVis}}" />
                                </StackPanel>
                            </ui:Card>

                            <!-- Network -->
                            <ui:Card Padding="16" Margin="0,0,0,12"
                                     Visibility="{Binding ViewModel.CorSpecReport.HasNetwork, Converter={StaticResource BoolToVis}}">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon Symbol="Globe24" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="Network" FontSize="15" FontWeight="SemiBold" />
                                    </StackPanel>
                                    <ItemsControl ItemsSource="{Binding ViewModel.CorSpecReport.NetworkAdapters}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Margin="0,0,0,6">
                                                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold" />
                                                    <Grid Margin="140,2,0,0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="60" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>
                                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Status" Opacity="0.6" />
                                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Status}" />
                                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="IP" Opacity="0.6" />
                                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding IpAddress}" />
                                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="MAC" Opacity="0.6" />
                                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding MacAddress}" FontFamily="Consolas" />
                                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Speed" Opacity="0.6" />
                                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SpeedDisplay}" />
                                                    </Grid>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </ui:Card>

                            <!-- Battery (hidden on desktops) -->
                            <ui:Card Padding="16" Margin="0,0,0,12"
                                     Visibility="{Binding ViewModel.CorSpecReport.HasBattery, Converter={StaticResource BoolToVis}}">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <ui:SymbolIcon Symbol="Battery524" Foreground="{DynamicResource SystemAccentColorPrimaryBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="Battery" FontSize="15" FontWeight="SemiBold" />
                                    </StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="140" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Health" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.Battery.HealthPercent, StringFormat={}{0:F1}%}" FontWeight="SemiBold" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Design Capacity" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.Battery.DesignCapacityFormatted}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Full Charge" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.Battery.FullChargeFormatted}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Cycle Count" Opacity="0.6" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.Battery.CycleCount}" Margin="0,0,0,4" />
                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Chemistry" Opacity="0.6" />
                                        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding ViewModel.CorSpecReport.Battery.Chemistry}" />
                                    </Grid>
                                </StackPanel>
                            </ui:Card>

                            <!-- Footer -->
                            <TextBlock HorizontalAlignment="Center" Opacity="0.4" FontSize="12" Margin="0,8,0,0">
                                <Run Text="COR Intelligence — Generated " />
                                <Run Text="{Binding ViewModel.CorSpecReport.GeneratedAtFormatted, Mode=OneWay}" />
                            </TextBlock>

                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <!-- ============================================================ -->
            <!-- TAB 1: System Overview -->
            <!-- ============================================================ -->
            <TabItem Header="System Info">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                    <StackPanel>
                        <ui:Card Padding="16" Margin="0,0,0,12">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="130" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Operating System"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="0" Grid.Column="1"
                                           Text="{Binding ViewModel.OsInfo}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Processor"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="1" Grid.Column="1"
                                           Text="{Binding ViewModel.CpuInfo}"
                                           TextWrapping="Wrap" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Graphics"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="2" Grid.Column="1"
                                           Text="{Binding ViewModel.GpuInfo}"
                                           TextWrapping="Wrap" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Motherboard"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="3" Grid.Column="1"
                                           Text="{Binding ViewModel.MotherboardInfo}"
                                           TextWrapping="Wrap" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Total RAM"
                                           FontWeight="SemiBold" />
                                <TextBlock Grid.Row="4" Grid.Column="1"
                                           Text="{Binding ViewModel.TotalRam}" />
                            </Grid>
                        </ui:Card>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- ============================================================ -->
            <!-- TAB 2: RAM -->
            <!-- ============================================================ -->
            <TabItem Header="RAM">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:Button Grid.Row="0" Content="Load RAM Info"
                               Command="{Binding ViewModel.LoadRamInfoCommand}"
                               Appearance="Primary" Margin="0,0,0,12" />

                    <ui:Card Grid.Row="1" Padding="12" Margin="0,0,0,12">
                        <StackPanel>
                            <TextBlock Text="{Binding ViewModel.RamSlotSummary}"
                                       FontSize="14" TextWrapping="Wrap" />
                        </StackPanel>
                    </ui:Card>

                    <ui:Card Grid.Row="2" Padding="12" Margin="0,0,0,12"
                             Visibility="{Binding ViewModel.RamUpgradeAdvice, Converter={StaticResource StringToVis}}">
                        <StackPanel>
                            <TextBlock Text="Upgrade Advice" FontWeight="SemiBold" Margin="0,0,0,4" />
                            <TextBlock Text="{Binding ViewModel.RamUpgradeAdvice}"
                                       TextWrapping="Wrap" Opacity="0.8" />
                        </StackPanel>
                    </ui:Card>

                    <DataGrid Grid.Row="3"
                              ItemsSource="{Binding ViewModel.RamDimms}"
                              IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Slot" Binding="{Binding SlotLabel}" Width="80" />
                            <DataGridTextColumn Header="Capacity" Binding="{Binding CapacityFormatted}" Width="80" />
                            <DataGridTextColumn Header="Type" Binding="{Binding MemoryType}" Width="70" />
                            <DataGridTextColumn Header="Speed" Binding="{Binding SpeedMhz, StringFormat={}{0} MHz}" Width="100" />
                            <DataGridTextColumn Header="Manufacturer" Binding="{Binding Manufacturer}" Width="120" />
                            <DataGridTextColumn Header="Part Number" Binding="{Binding PartNumber}" Width="*" />
                            <DataGridTextColumn Header="ECC" Binding="{Binding IsEcc}" Width="50" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- ============================================================ -->
            <!-- TAB 3: Battery -->
            <!-- ============================================================ -->
            <TabItem Header="Battery">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                    <StackPanel Margin="16">
                        <ui:Button Content="Load Battery Info"
                                   Command="{Binding ViewModel.LoadBatteryInfoCommand}"
                                   Appearance="Primary" Margin="0,0,0,16" />

                        <ui:Card Padding="16"
                                 Visibility="{Binding ViewModel.HasBattery, Converter={StaticResource BoolToVis}}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="160" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Health"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="0" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryHealth}"
                                           FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Current Charge"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,0,8">
                                    <ProgressBar Value="{Binding ViewModel.BatteryPercent, Mode=OneWay}"
                                                 Maximum="100" Height="12" />
                                    <TextBlock Text="{Binding ViewModel.BatteryPercent, StringFormat={}{0}%}"
                                               HorizontalAlignment="Right" FontSize="11" Opacity="0.7" />
                                </StackPanel>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Design Capacity"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="2" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryDesign}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Full Charge Capacity"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="3" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryFullCharge}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Cycle Count"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="4" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryCycles}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="5" Grid.Column="0" Text="Chemistry"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="5" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryChemistry}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2"
                                           Text="Battery needs replacement"
                                           Foreground="OrangeRed"
                                           FontWeight="SemiBold"
                                           FontSize="14"
                                           Visibility="{Binding ViewModel.BatteryNeedsReplacement, Converter={StaticResource BoolToVis}}" />
                            </Grid>
                        </ui:Card>

                        <ui:Card Padding="16"
                                 Visibility="{Binding ViewModel.HasBattery, Converter={StaticResource InverseBoolToVis}}">
                            <TextBlock Text="No battery detected — this appears to be a desktop computer."
                                       Opacity="0.6" FontSize="14" />
                        </ui:Card>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- ============================================================ -->
            <!-- TAB 4: Product Key -->
            <!-- ============================================================ -->
            <TabItem Header="Product Key">
                <StackPanel Margin="16">
                    <ui:Button Content="Recover Product Key"
                               Command="{Binding ViewModel.LoadProductKeyCommand}"
                               Appearance="Primary" Margin="0,0,0,16" />

                    <ui:Card Padding="16">
                        <StackPanel>
                            <TextBlock Text="Windows Product Key" FontWeight="SemiBold" Margin="0,0,0,8" />
                            <TextBox Text="{Binding ViewModel.ProductKey, Mode=OneWay}"
                                     IsReadOnly="True"
                                     FontFamily="Consolas"
                                     FontSize="18" />
                        </StackPanel>
                    </ui:Card>
                </StackPanel>
            </TabItem>

            <!-- ============================================================ -->
            <!-- TAB 5: Wi-Fi Passwords -->
            <!-- ============================================================ -->
            <TabItem Header="Wi-Fi Passwords">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:Button Grid.Row="0" Content="Load Wi-Fi Passwords"
                               Command="{Binding ViewModel.LoadWifiPasswordsCommand}"
                               Appearance="Primary" Margin="0,0,0,12" />

                    <DataGrid Grid.Row="1"
                              ItemsSource="{Binding ViewModel.WifiProfiles}"
                              IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Network Name (SSID)"
                                                Binding="{Binding Ssid}" Width="200" />
                            <DataGridTextColumn Header="Security"
                                                Binding="{Binding SecurityType}" Width="120" />
                            <DataGridTextColumn Header="Password"
                                                Binding="{Binding Password}" Width="*" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- ============================================================ -->
            <!-- TAB 6: Drivers -->
            <!-- ============================================================ -->
            <TabItem Header="Drivers">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                        <ui:Button Content="Load Drivers"
                                   Command="{Binding ViewModel.LoadDriversCommand}"
                                   Appearance="Primary" Margin="0,0,12,0" />
                        <ui:TextBox PlaceholderText="Filter by name, manufacturer, or class..."
                                    Text="{Binding ViewModel.DriverFilter, UpdateSourceTrigger=PropertyChanged}"
                                    MinWidth="300" />
                    </StackPanel>

                    <TextBlock Grid.Row="1" Margin="0,0,0,8" Opacity="0.6" FontSize="12"
                               Text="Sorted oldest-first — outdated drivers appear at the top." />

                    <DataGrid Grid.Row="2"
                              ItemsSource="{Binding ViewModel.FilteredDrivers}"
                              IsReadOnly="True"
                              AutoGenerateColumns="False"
                              VerticalScrollBarVisibility="Auto"
                              EnableRowVirtualization="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Device Name" Binding="{Binding DeviceName}" Width="250" />
                            <DataGridTextColumn Header="Class" Binding="{Binding DeviceClass}" Width="100" />
                            <DataGridTextColumn Header="Manufacturer" Binding="{Binding Manufacturer}" Width="150" />
                            <DataGridTextColumn Header="Version" Binding="{Binding DriverVersion}" Width="120" />
                            <DataGridTextColumn Header="Date" Binding="{Binding DriverDateFormatted}" Width="100" />
                            <DataGridTextColumn Header="Age" Binding="{Binding AgeSummary}" Width="*" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- ============================================================ -->
            <!-- TAB 7: Software Inventory (moved from ToolsPage) -->
            <!-- ============================================================ -->
            <TabItem Header="Software Inventory">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- Controls -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                        <ui:Button Content="Load Installed Software"
                                   Appearance="Primary"
                                   Command="{Binding ViewModel.LoadSoftwareCommand}"
                                   MinWidth="180" Margin="0,0,12,0" />
                        <ui:Button Content="Export CSV"
                                   Command="{Binding ViewModel.ExportSoftwareCsvCommand}"
                                   MinWidth="100" Margin="0,0,12,0" />
                        <CheckBox Content="Include system components"
                                  IsChecked="{Binding ViewModel.IncludeSystemComponents}"
                                  VerticalAlignment="Center" />
                    </StackPanel>

                    <!-- Search filter -->
                    <ui:TextBox Grid.Row="1"
                                PlaceholderText="Search by name or publisher..."
                                Text="{Binding ViewModel.SoftwareSearchFilter, UpdateSourceTrigger=PropertyChanged}"
                                Margin="0,0,0,12" />

                    <!-- Software list -->
                    <DataGrid Grid.Row="2"
                              ItemsSource="{Binding ViewModel.FilteredSoftware}"
                              IsReadOnly="True"
                              AutoGenerateColumns="False"
                              VerticalScrollBarVisibility="Auto"
                              EnableRowVirtualization="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding DisplayName}" Width="*" />
                            <DataGridTextColumn Header="Publisher" Binding="{Binding Publisher}" Width="180" />
                            <DataGridTextColumn Header="Version" Binding="{Binding DisplayVersion}" Width="120" />
                            <DataGridTextColumn Header="Installed" Binding="{Binding InstallDateFormatted}" Width="100" />
                            <DataGridTextColumn Header="Size" Binding="{Binding SizeFormatted}" Width="100">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Loading indicator -->
                    <ProgressBar Grid.Row="3"
                                 IsIndeterminate="True"
                                 Height="4"
                                 Margin="0,8,0,0"
                                 Visibility="{Binding ViewModel.IsLoadingSoftware, Converter={StaticResource BoolToVis}}" />
                </Grid>
            </TabItem>

            <!-- ============================================================ -->
            <!-- TAB 8: Processes (moved from ToolsPage) -->
            <!-- ============================================================ -->
            <TabItem Header="Processes">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Controls -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                        <ui:Button Content="Refresh Processes"
                                   Appearance="Primary"
                                   Command="{Binding ViewModel.LoadProcessesCommand}"
                                   MinWidth="160" Margin="0,0,12,0" />
                        <ui:Button Content="Kill Process"
                                   Appearance="Danger"
                                   Command="{Binding ViewModel.KillSelectedProcessCommand}"
                                   MinWidth="110" Margin="0,0,12,0" />
                        <ui:Button Content="Open File Location"
                                   Command="{Binding ViewModel.OpenProcessLocationCommand}"
                                   MinWidth="140" Margin="0,0,16,0" />
                        <TextBlock Text="CPU usage sampled over ~500ms interval"
                                   VerticalAlignment="Center" Opacity="0.5" FontSize="12" />
                    </StackPanel>

                    <!-- Search filter -->
                    <ui:TextBox Grid.Row="1"
                                PlaceholderText="Search by name, description, or PID..."
                                Text="{Binding ViewModel.ProcessSearchFilter, UpdateSourceTrigger=PropertyChanged}"
                                Margin="0,0,0,12" />

                    <!-- Process list -->
                    <DataGrid Grid.Row="2"
                              ItemsSource="{Binding ViewModel.FilteredProcesses}"
                              SelectedItem="{Binding ViewModel.SelectedProcess}"
                              SelectionMode="Single"
                              IsReadOnly="True"
                              AutoGenerateColumns="False"
                              VerticalScrollBarVisibility="Auto"
                              EnableRowVirtualization="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="PID" Binding="{Binding Pid}" Width="65">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="FontFamily" Value="Consolas" />
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="180" />
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*" />
                            <DataGridTextColumn Header="CPU %" Binding="{Binding CpuFormatted}" Width="65">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                        <Setter Property="FontFamily" Value="Consolas" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Memory" Binding="{Binding WorkingSetFormatted}" Width="90">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Private" Binding="{Binding PrivateBytesFormatted}" Width="90">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Threads" Binding="{Binding ThreadCount}" Width="65">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Handles" Binding="{Binding HandleCount}" Width="65">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Started" Binding="{Binding StartTimeFormatted}" Width="120" />
                        </DataGrid.Columns>

                        <!-- Row colour coding by resource usage -->
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow"
                                   BasedOn="{StaticResource {x:Type DataGridRow}}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding CpuLevel}" Value="High">
                                        <Setter Property="Foreground" Value="#F44336" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding CpuLevel}" Value="Medium">
                                        <Setter Property="Foreground" Value="#FF9800" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding MemoryLevel}" Value="High">
                                        <Setter Property="Background" Value="#22F44336" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsSystem}" Value="True">
                                        <Setter Property="Opacity" Value="0.55" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- ============================================================ -->
            <!-- TAB 9: Memory Explorer (moved from ToolsPage) -->
            <!-- ============================================================ -->
            <TabItem Header="Memory">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- Controls -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                        <ui:Button Content="Refresh Memory"
                                   Appearance="Primary"
                                   Command="{Binding ViewModel.LoadMemoryCommand}"
                                   MinWidth="160" Margin="0,0,16,0" />
                        <TextBlock Text="Physical RAM, page file usage, and top consumers by working set"
                                   VerticalAlignment="Center" Opacity="0.5" FontSize="12" />
                    </StackPanel>

                    <!-- Memory overview cards -->
                    <Grid Grid.Row="1" Margin="0,0,0,16"
                          Visibility="{Binding ViewModel.CurrentMemoryInfo, Converter={StaticResource NullToVis}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- Physical RAM card -->
                        <ui:Card Grid.Column="0" Padding="16" Margin="0,0,8,0">
                            <StackPanel>
                                <TextBlock Text="Physical RAM" FontWeight="SemiBold"
                                           Opacity="0.7" Margin="0,0,0,8" />
                                <ProgressBar Value="{Binding ViewModel.CurrentMemoryInfo.UsedPhysicalPercent, Mode=OneWay}"
                                             Maximum="100" Height="8" Margin="0,0,0,8" />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Used:" Opacity="0.6" Margin="0,0,8,2" />
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ViewModel.CurrentMemoryInfo.UsedFormatted}"
                                               FontWeight="SemiBold" HorizontalAlignment="Right" />
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Available:" Opacity="0.6" Margin="0,0,8,2" />
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ViewModel.CurrentMemoryInfo.AvailableFormatted}"
                                               HorizontalAlignment="Right" />
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Total:" Opacity="0.6" Margin="0,0,8,0" />
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ViewModel.CurrentMemoryInfo.TotalFormatted}"
                                               HorizontalAlignment="Right" />
                                </Grid>
                            </StackPanel>
                        </ui:Card>

                        <!-- Page File card -->
                        <ui:Card Grid.Column="1" Padding="16" Margin="4,0,4,0">
                            <StackPanel>
                                <TextBlock Text="Page File" FontWeight="SemiBold"
                                           Opacity="0.7" Margin="0,0,0,8" />
                                <ProgressBar Value="{Binding ViewModel.CurrentMemoryInfo.UsedPageFilePercent, Mode=OneWay}"
                                             Maximum="100" Height="8" Margin="0,0,0,8" />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Used:" Opacity="0.6" Margin="0,0,8,2" />
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding ViewModel.CurrentMemoryInfo.PageFileUsedFormatted}"
                                               FontWeight="SemiBold" HorizontalAlignment="Right" />
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Total:" Opacity="0.6" Margin="0,0,8,0" />
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ViewModel.CurrentMemoryInfo.PageFileTotalFormatted}"
                                               HorizontalAlignment="Right" />
                                </Grid>
                            </StackPanel>
                        </ui:Card>

                        <!-- Health status card -->
                        <ui:Card Grid.Column="2" Padding="16" Margin="8,0,0,0">
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock Text="Health" FontWeight="SemiBold"
                                           Opacity="0.7" Margin="0,0,0,8"
                                           HorizontalAlignment="Center" />
                                <TextBlock Text="{Binding ViewModel.CurrentMemoryInfo.MemoryLoadPercent, StringFormat={}{0}%}"
                                           FontSize="32" FontWeight="Bold"
                                           HorizontalAlignment="Center" />
                                <TextBlock Text="{Binding ViewModel.CurrentMemoryInfo.HealthLevel}"
                                           FontSize="14" FontWeight="SemiBold"
                                           HorizontalAlignment="Center"
                                           Margin="0,4,0,0" />
                            </StackPanel>
                        </ui:Card>
                    </Grid>

                    <!-- Top memory consumers grid -->
                    <DataGrid Grid.Row="2"
                              ItemsSource="{Binding ViewModel.MemoryConsumers}"
                              IsReadOnly="True"
                              AutoGenerateColumns="False"
                              VerticalScrollBarVisibility="Auto"
                              EnableRowVirtualization="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="PID" Binding="{Binding Pid}" Width="65">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="FontFamily" Value="Consolas" />
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Process" Binding="{Binding Name}" Width="*" />
                            <DataGridTextColumn Header="Working Set" Binding="{Binding WorkingSetFormatted}" Width="110">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Private Bytes" Binding="{Binding PrivateBytesFormatted}" Width="110">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="% RAM" Binding="{Binding PercentFormatted}" Width="70">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right" />
                                        <Setter Property="FontFamily" Value="Consolas" />
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>

                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow"
                                   BasedOn="{StaticResource {x:Type DataGridRow}}" />
                        </DataGrid.RowStyle>
                    </DataGrid>

                    <!-- Loading indicator -->
                    <ProgressBar Grid.Row="3"
                                 IsIndeterminate="True"
                                 Height="4"
                                 Margin="0,8,0,0"
                                 Visibility="{Binding ViewModel.IsLoadingMemory, Converter={StaticResource BoolToVis}}" />
                </Grid>
            </TabItem>

        </TabControl>

        <!-- Status bar -->
        <TextBlock Grid.Row="1"
                   Text="{Binding ViewModel.StatusText}"
                   Opacity="0.6"
                   FontSize="12"
                   Margin="0,8,0,0" />
    </Grid>

</Page>
