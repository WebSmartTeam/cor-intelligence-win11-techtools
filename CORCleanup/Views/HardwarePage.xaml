<Page x:Class="CORCleanup.Views.HardwarePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      Title="Hardware"
      Loaded="Page_Loaded">


    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TabControl Grid.Row="0"
                    SelectedIndex="{Binding ViewModel.SelectedTabIndex}">

            <!-- System Overview Tab -->
            <TabItem Header="System Info">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                    <StackPanel>
                        <ui:Card Padding="16" Margin="0,0,0,12">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="130" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Operating System"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="0" Grid.Column="1"
                                           Text="{Binding ViewModel.OsInfo}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Processor"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="1" Grid.Column="1"
                                           Text="{Binding ViewModel.CpuInfo}"
                                           TextWrapping="Wrap" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Graphics"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="2" Grid.Column="1"
                                           Text="{Binding ViewModel.GpuInfo}"
                                           TextWrapping="Wrap" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Motherboard"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="3" Grid.Column="1"
                                           Text="{Binding ViewModel.MotherboardInfo}"
                                           TextWrapping="Wrap" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Total RAM"
                                           FontWeight="SemiBold" />
                                <TextBlock Grid.Row="4" Grid.Column="1"
                                           Text="{Binding ViewModel.TotalRam}" />
                            </Grid>
                        </ui:Card>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- RAM Tab -->
            <TabItem Header="RAM">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:Button Grid.Row="0" Content="Load RAM Info"
                               Command="{Binding ViewModel.LoadRamInfoCommand}"
                               Appearance="Primary" Margin="0,0,0,12" />

                    <ui:Card Grid.Row="1" Padding="12" Margin="0,0,0,12">
                        <StackPanel>
                            <TextBlock Text="{Binding ViewModel.RamSlotSummary}"
                                       FontSize="14" TextWrapping="Wrap" />
                        </StackPanel>
                    </ui:Card>

                    <ui:Card Grid.Row="2" Padding="12" Margin="0,0,0,12"
                             Visibility="{Binding ViewModel.RamUpgradeAdvice, Converter={StaticResource StringToVis}}">
                        <StackPanel>
                            <TextBlock Text="Upgrade Advice" FontWeight="SemiBold" Margin="0,0,0,4" />
                            <TextBlock Text="{Binding ViewModel.RamUpgradeAdvice}"
                                       TextWrapping="Wrap" Opacity="0.8" />
                        </StackPanel>
                    </ui:Card>

                    <DataGrid Grid.Row="3"
                              ItemsSource="{Binding ViewModel.RamDimms}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Slot" Binding="{Binding SlotLabel}" Width="80" />
                            <DataGridTextColumn Header="Capacity" Binding="{Binding CapacityFormatted}" Width="80" />
                            <DataGridTextColumn Header="Type" Binding="{Binding MemoryType}" Width="70" />
                            <DataGridTextColumn Header="Speed" Binding="{Binding SpeedMhz, StringFormat={}{0} MHz}" Width="100" />
                            <DataGridTextColumn Header="Manufacturer" Binding="{Binding Manufacturer}" Width="120" />
                            <DataGridTextColumn Header="Part Number" Binding="{Binding PartNumber}" Width="*" />
                            <DataGridTextColumn Header="ECC" Binding="{Binding IsEcc}" Width="50" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Disk Health Tab -->
            <TabItem Header="Disk Health">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:Button Grid.Row="0" Content="Load Disk Health"
                               Command="{Binding ViewModel.LoadDiskHealthCommand}"
                               Appearance="Primary" Margin="0,0,0,12" />

                    <DataGrid Grid.Row="1"
                              ItemsSource="{Binding ViewModel.Disks}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Model" Binding="{Binding Model}" Width="200" />
                            <DataGridTextColumn Header="Size" Binding="{Binding SizeFormatted}" Width="80" />
                            <DataGridTextColumn Header="Type" Binding="{Binding MediaType}" Width="80" />
                            <DataGridTextColumn Header="Interface" Binding="{Binding InterfaceType}" Width="80" />
                            <DataGridTextColumn Header="Health" Binding="{Binding OverallHealth}" Width="80" />
                            <DataGridTextColumn Header="Temp" Binding="{Binding TemperatureCelsius, StringFormat={}{0} C}" Width="60" />
                            <DataGridTextColumn Header="Power On (hrs)" Binding="{Binding PowerOnHours}" Width="100" />
                            <DataGridTextColumn Header="Wear %" Binding="{Binding WearLevellingPercent}" Width="70" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Battery Tab -->
            <TabItem Header="Battery">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                    <StackPanel Margin="16">
                        <ui:Button Content="Load Battery Info"
                                   Command="{Binding ViewModel.LoadBatteryInfoCommand}"
                                   Appearance="Primary" Margin="0,0,0,16" />

                        <ui:Card Padding="16"
                                 Visibility="{Binding ViewModel.HasBattery, Converter={StaticResource BoolToVis}}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="160" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Health"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="0" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryHealth}"
                                           FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Current Charge"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,0,8">
                                    <ProgressBar Value="{Binding ViewModel.BatteryPercent}"
                                                 Maximum="100" Height="12" />
                                    <TextBlock Text="{Binding ViewModel.BatteryPercent, StringFormat={}{0}%}"
                                               HorizontalAlignment="Right" FontSize="11" Opacity="0.7" />
                                </StackPanel>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Design Capacity"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="2" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryDesign}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Full Charge Capacity"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="3" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryFullCharge}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Cycle Count"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="4" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryCycles}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="5" Grid.Column="0" Text="Chemistry"
                                           FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Grid.Row="5" Grid.Column="1"
                                           Text="{Binding ViewModel.BatteryChemistry}" Margin="0,0,0,8" />

                                <TextBlock Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2"
                                           Text="Battery needs replacement"
                                           Foreground="OrangeRed"
                                           FontWeight="SemiBold"
                                           FontSize="14"
                                           Visibility="{Binding ViewModel.BatteryNeedsReplacement, Converter={StaticResource BoolToVis}}" />
                            </Grid>
                        </ui:Card>

                        <ui:Card Padding="16"
                                 Visibility="{Binding ViewModel.HasBattery, Converter={StaticResource InverseBoolToVis}}">
                            <TextBlock Text="No battery detected â€” this appears to be a desktop computer."
                                       Opacity="0.6" FontSize="14" />
                        </ui:Card>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Product Key Tab -->
            <TabItem Header="Product Key">
                <StackPanel Margin="16">
                    <ui:Button Content="Recover Product Key"
                               Command="{Binding ViewModel.LoadProductKeyCommand}"
                               Appearance="Primary" Margin="0,0,0,16" />

                    <ui:Card Padding="16">
                        <StackPanel>
                            <TextBlock Text="Windows Product Key" FontWeight="SemiBold" Margin="0,0,0,8" />
                            <TextBox Text="{Binding ViewModel.ProductKey, Mode=OneWay}"
                                     IsReadOnly="True"
                                     FontFamily="Consolas"
                                     FontSize="18" />
                        </StackPanel>
                    </ui:Card>
                </StackPanel>
            </TabItem>

            <!-- Wi-Fi Passwords Tab -->
            <TabItem Header="Wi-Fi Passwords">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:Button Grid.Row="0" Content="Load Wi-Fi Passwords"
                               Command="{Binding ViewModel.LoadWifiPasswordsCommand}"
                               Appearance="Primary" Margin="0,0,0,12" />

                    <DataGrid Grid.Row="1"
                              ItemsSource="{Binding ViewModel.WifiProfiles}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Network Name (SSID)"
                                                Binding="{Binding Ssid}" Width="200" />
                            <DataGridTextColumn Header="Security"
                                                Binding="{Binding SecurityType}" Width="120" />
                            <DataGridTextColumn Header="Password"
                                                Binding="{Binding Password}" Width="*" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Status bar -->
        <TextBlock Grid.Row="1"
                   Text="{Binding ViewModel.StatusText}"
                   Opacity="0.6"
                   FontSize="12"
                   Margin="0,8,0,0" />
    </Grid>

</Page>
