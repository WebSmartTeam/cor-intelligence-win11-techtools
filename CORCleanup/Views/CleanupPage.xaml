<Page x:Class="CORCleanup.Views.CleanupPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      Title="Cleanup">

    <Grid Margin="12,8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Action buttons -->
        <Grid Grid.Row="0" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <ui:Button Grid.Column="0"
                       Content="Scan"
                       Appearance="Primary"
                       Command="{Binding ViewModel.ScanCommand}"
                       MinWidth="100"
                       Margin="0,0,8,0" />
            <ui:Button Grid.Column="1"
                       Content="Clean Selected"
                       Appearance="Success"
                       Command="{Binding ViewModel.CleanCommand}"
                       MinWidth="120"
                       Margin="0,0,8,0" />
            <ui:Button Grid.Column="2"
                       Content="Stop"
                       Appearance="Danger"
                       Command="{Binding ViewModel.StopCleanCommand}"
                       MinWidth="80"
                       Margin="0,0,8,0" />

            <ui:Button Grid.Column="4"
                       Content="Select All"
                       Command="{Binding ViewModel.SelectAllCommand}"
                       MinWidth="80"
                       Margin="0,0,4,0" />
            <ui:Button Grid.Column="5"
                       Content="Select None"
                       Command="{Binding ViewModel.SelectNoneCommand}"
                       MinWidth="80"
                       Margin="0,0,4,0" />
            <ui:Button Grid.Column="6"
                       Content="Defaults"
                       Command="{Binding ViewModel.SelectDefaultsCommand}"
                       MinWidth="80" />
        </Grid>

        <!-- Summary card -->
        <ui:Card Grid.Row="1" Margin="0,0,0,16" Padding="16"
                 Visibility="{Binding ViewModel.HasScanned, Converter={StaticResource BoolToVis}}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Total cleanable space: "
                           VerticalAlignment="Center"
                           Opacity="0.7" />
                <TextBlock Text="{Binding ViewModel.TotalSizeText}"
                           FontSize="18"
                           FontWeight="SemiBold"
                           VerticalAlignment="Center" />
            </StackPanel>
        </ui:Card>

        <!-- Cleanup items list -->
        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding ViewModel.CleanupItems}"
                  IsReadOnly="False"
                  SelectionMode="Single">
            <DataGrid.Columns>
                <DataGridCheckBoxColumn Header=""
                                         Binding="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}"
                                         Width="40" />
                <DataGridTextColumn Header="Category"
                                    Binding="{Binding DisplayName}"
                                    Width="200"
                                    IsReadOnly="True" />
                <DataGridTextColumn Header="Description"
                                    Binding="{Binding Description}"
                                    Width="*"
                                    IsReadOnly="True" />
                <DataGridTextColumn Header="Size"
                                    Binding="{Binding SizeFormatted}"
                                    Width="100"
                                    IsReadOnly="True" />
            </DataGrid.Columns>
        </DataGrid>

        <!-- Results output -->
        <TextBox Grid.Row="3"
                 Text="{Binding ViewModel.ResultText, Mode=OneWay}"
                 IsReadOnly="True"
                 FontFamily="Consolas"
                 FontSize="12"
                 AcceptsReturn="True"
                 TextWrapping="Wrap"
                 VerticalScrollBarVisibility="Auto"
                 MaxHeight="200"
                 Margin="0,12,0,0"
                 Visibility="{Binding ViewModel.ResultText, Converter={StaticResource StringToVis}}" />

        <!-- Status bar -->
        <TextBlock Grid.Row="4"
                   Text="{Binding ViewModel.StatusText}"
                   Opacity="0.6"
                   FontSize="12"
                   Margin="0,8,0,0" />
    </Grid>

</Page>
